## http 请求 -- 浏览器缓存

#### 基本介绍

- 在Chrome浏览器中的控制台Network中size栏通常会有**三种状态**:

- 1. **资源本身的大小** (如下图：197B)
  2. **from memory cache** (如下图：idnex.js)
  3. **from disk cache** (如下图：css.js)

![](https://user-gold-cdn.xitu.io/2020/1/6/16f7ac75367c3e59?w=1914&h=488&f=png&s=69480)


from memory cache

> 代表使用内存中的缓存

- from memory cache 代表使用内存中的缓存，即请求的资源是直接从内存中拿到的，不会请求服务器。
- 一般已经加载过该资源且资源已经缓存在了内存当中，当关闭该页面时，此资源就被内存释放掉了**，**再次重新打开相同页面时不会出现 from memory cache 的情况。
- 内存缓存具有两个特点，分别是快速读取和时效性：

- - **快速读取**：内存缓存会将编译解析后的文件，直接存入该进程的内存中，占据该进程一定的内存资源，以方便下次运行使用时的快速读取。
  - **时效性**：一旦该进程关闭，则该进程的内存则会清空。

from disk cache 

> 代表使用的是硬盘中的缓存

- from disk cache 表示此资源是从磁盘当中取出的，也是在已经在之前的某个时间加载过该资源，不会请求服务器。但此资源不会随着该页面的关闭而释放掉，因为是存在硬盘当中的，下次打开仍会出现 from disk cache的情况。
- 硬盘缓存(from disk cache)：硬盘缓存则是直接将缓存写入硬盘文件中，读取缓存需要对该缓存存放的硬盘文件进行 I/O 操作，然后重新解析该缓存内容，读取复杂，速度比内存缓存慢。

浏览器读取命中强缓存资源顺序为 memory ---> disk

- - 先去 `内存` 看，如果有，直接加载；
  - 如果内存没有，则取 `硬盘` 获取；
  - 如果硬盘也没有，那么就进行 `网络请求`；
  - 加载到的 `资源缓存到硬盘和内存`。

资源本身大小

- 当HTTP状态码为 200 时，资源是实实在在从服务器请求后获取得到的（不是缓存数据），该数字是资源本身的大小；
- 当HTTP状态码为 304 时，该数字是 `与服务端通信报文的大小`，并 `不是该资源本身的大小`，该资源是从本地获取的（协商缓存）。

#### Chrome 采取措施的准则

| 状态 | 类型              | 说明                                                         |
| ---- | ----------------- | ------------------------------------------------------------ |
| 200  | from memory cache | 不请求网络资源，资源在内存当中，一般`脚本`、`字体`、`图片`会存在内存当中 |
| 200  | from disk cache   | 不请求网络资源，在磁盘当中，一般非脚本会存在内存当中，如`CSS`等 |
| 200  | 资源大小数值      | 从服务器下载最新资源                                         |
| 304  | 报文大小          | 请求服务端发现资源没有更新，使用本地资源（协商缓存）         |

所以 `样式表` 一般在磁盘中，不会缓存到内存中去，因为CSS样式加载一次即可渲染出网页。但是，` 脚本` 却可能随时会执行，如果 `脚本 ` 在磁盘当中，在执行该 `脚本` 需要从磁盘中取到内存当中来。这样的IO开销是比较大的，有可能会导致浏览器失去响应。因此，`脚本` 一般在内存中。