<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
  <style type="text/css">
    body,
    html,
    #allmap {
      width: 100%;
      height: 100%;
      overflow: hidden;
      margin: 0;
      font-family: "微软雅黑";
    }
  </style>
  <script type="text/javascript" src="http://api.map.baidu.com/api?v=2.0&ak=fMqHe6T6OOUgsk3GIG01XYasYLG8gCxg"></script>
  <title>在百度地图中显示电动车的运动轨迹</title>
</head>
<body>
  <div id="allmap"></div>
</body>
</html>
<script type="text/javascript">
  function readTextFile(file) {
    var rawFile = new XMLHttpRequest();
    rawFile.open("GET", file, false);
    rawFile.onreadystatechange = function () {
      if (rawFile.readyState === 4) {
        if (rawFile.status === 200 || rawFile.status == 0) {
          var arr = [];
          var allText = rawFile.responseText;
          allText = allText.split('\n');
          window.allText = allText;
          for (var x in allText) {
            if (Number(x) === 0) {
              continue;
            }
            var _ele = allText[x].split(',');
            arr.push({
              x: _ele[3],
              y: _ele[2]
            });
          }
          mapIni(arr)
        }
      }
    };
    rawFile.send(null);
  }

  readTextFile("2.txt");
  function mapIni(arr) {
    // 百度地图API功能
    var map = new BMap.Map("allmap"); // 创建Map实例
    map.centerAndZoom(new BMap.Point(120.202914, 30.193124), 22); // 初始化地图,设置中心点坐标和地图级别
    map.enableScrollWheelZoom(true); //开启鼠标滚轮缩放
    var sy = new BMap.Symbol(BMap_Symbol_SHAPE_BACKWARD_OPEN_ARROW, {
      scale: 0.6, //图标缩放大小
      strokeColor: '#fff', //设置矢量图标的线填充颜色
      strokeWeight: '2' //设置线宽
    });
    var icons = new BMap.IconSequence(sy, '10', '30');
    // 创建polyline对象
    var pois = [];
    for (var i in arr) {
      var _data = new BMap.Point(arr[i].x, arr[i].y)
      pois.push(_data)
    }
    var polyline = new BMap.Polyline(pois, {
      enableEditing: false, //是否启用线编辑，默认为false
      enableClicking: true, //是否响应点击事件，默认为true
      icons: [icons],
      strokeWeight: '8', //折线的宽度，以像素为单位
      strokeOpacity: 0.8, //折线的透明度，取值范围0 - 1
      strokeColor: "#18a45b" //折线颜色
    });
    map.addOverlay(polyline); //增加折线
  }
</script>